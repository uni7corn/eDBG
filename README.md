<div align="center">
  <img src="logo.png"/>

  [![GitHub Release](https://img.shields.io/github/v/release/ShinoLeah/eDBG?style=flat-square)](https://github.com/ShinoLeah/eDBG/releases)
  [![License](https://img.shields.io/github/license/ShinoLeah/eDBG?style=flat-square)](LICENSE)
  [![Platform](https://img.shields.io/badge/platform-Android%20ARM64-red.svg?style=flat-square)](https://www.android.com/)
  ![GitHub Repo stars](https://img.shields.io/github/stars/ShinoLeah/eDBG)

  ç®€ä½“ä¸­æ–‡ | [English](README_EN.md)
</div>

> eDBG æ˜¯ä¸€æ¬¾åŸºäº eBPF çš„è½»é‡çº§ CLI è°ƒè¯•å™¨ã€‚<br />
>
> ç›¸æ¯”äºä¼ ç»Ÿçš„åŸºäº ptrace çš„è°ƒè¯•å™¨æ–¹æ¡ˆï¼ŒeDBG ä¸ç›´æ¥ä¾µå…¥æˆ–é™„åŠ ç¨‹åºï¼Œå…·æœ‰è¾ƒå¼ºçš„æŠ—å¹²æ‰°å’Œåæ£€æµ‹èƒ½åŠ›ã€‚

## âœ¨ ç‰¹æ€§

- åŸºäº eBPF å®ç°ï¼ŒåŸºæœ¬æ— è§†åè°ƒè¯•ã€‚
- æ”¯æŒå¸¸è§„è°ƒè¯•åŠŸèƒ½ï¼ˆè¯¦è§â€œå‘½ä»¤è¯¦æƒ…â€ï¼‰
- ä½¿ç”¨ç±»ä¼¼ [pwndbg](https://github.com/pwndbg/pwndbg) çš„ CLI ç•Œé¢å’Œç±»ä¼¼ GDB çš„äº¤äº’æ–¹å¼ï¼Œç®€å•æ˜“ä¸Šæ‰‹
- åŸºäºæ–‡ä»¶+åç§»çš„æ–­ç‚¹æ³¨å†Œæœºåˆ¶ï¼Œå¯ä»¥å¿«é€Ÿå¯åŠ¨ï¼Œæ”¯æŒå¤šçº¿ç¨‹æˆ–å¤šè¿›ç¨‹è°ƒè¯•ã€‚

## ğŸ’• æ¼”ç¤º

![](demo.png)

## ğŸš€ è¿è¡Œç¯å¢ƒ

- ç›®å‰ä»…æ”¯æŒ ARM64 æ¶æ„çš„ Android ç³»ç»Ÿï¼Œéœ€è¦ ROOT æƒé™ï¼Œæ¨èæ­é… [KernelSU](https://github.com/tiann/KernelSU) ä½¿ç”¨
- ç³»ç»Ÿå†…æ ¸ç‰ˆæœ¬5.10+ ï¼ˆå¯æ‰§è¡Œ`uname -r`æŸ¥çœ‹ï¼‰

## âš™ï¸ ä½¿ç”¨

1. ä¸‹è½½æœ€æ–° [Release](https://github.com/ShinoLeah/eDBG/releases) ç‰ˆæœ¬

2. æ¨é€åˆ°æ‰‹æœºçš„`/data/local/tmp`ç›®å½•ä¸‹ï¼Œæ·»åŠ å¯æ‰§è¡Œæƒé™

   ```shell
   adb push eDBG /data/local/tmp
   adb shell
   su
   chmod +x /data/local/tmp/eDBG
   ```

3. è¿è¡Œè°ƒè¯•å™¨

   ```shell
   ./eDBG -p com.pakcage.name -l libname.so -b 0x123456
   ```

   | é€‰é¡¹åç§° | å«ä¹‰                         |
   | -------- | ---------------------------- |
   | -p       | ç›®æ ‡åº”ç”¨åŒ…å                 |
   | -l       | ç›®æ ‡åŠ¨æ€åº“åç§°               |
   | -b       | åˆå§‹æ–­ç‚¹åç§»åˆ—è¡¨ï¼ˆé€—å·åˆ†éš”ï¼‰ |

   æ›´å¤šå¯åŠ¨é€‰é¡¹è§â€œè¿›é˜¶ä½¿ç”¨â€

4. è¿è¡Œè¢«è°ƒè¯• APP

   > eDBG ä¹Ÿå¯ä»¥ç›´æ¥é™„åŠ æ­£åœ¨è¿è¡Œçš„ APPï¼Œä½† eDBG ä¸ä¼šä¸»åŠ¨æ‹‰èµ·è¢«è°ƒè¯• APPã€‚

## âš ï¸ æ³¨æ„

- ç”±äºæœ¬é¡¹ç›®ä½¿ç”¨åŸºäºæ–‡ä»¶+åç§»çš„æ–­ç‚¹æ³¨å†Œæœºåˆ¶ï¼Œåœ¨è°ƒè¯•ç³»ç»Ÿåº“ï¼ˆ`libc.so`ã€`libart.so`ï¼‰æ—¶å¯èƒ½ä¼šæ¯”è¾ƒå¡é¡¿ã€‚
- **é‡è¦**ï¼šæœ¬é¡¹ç›®ä¸èƒ½éšæ—¶æš‚åœè¢«è°ƒè¯•ç¨‹åºï¼Œå› æ­¤**å¿…é¡»ç”¨ -b å¯åŠ¨é€‰é¡¹åœ¨å¯ç”¨ä½ç½®å…ˆæ–­ä¸‹ç¨‹åºæ‰èƒ½è¿›è¡Œåç»­è°ƒè¯•**ã€‚
- è¯¥é¡¹ç›®å¯ä»¥åœ¨ç›®æ ‡ç¨‹åºè¿è¡Œä¹‹å‰è¢«è¿è¡Œï¼Œå› æ­¤ä¸æ”¯æŒåœ¨å¯åŠ¨æ—¶æŒ‡å®šçº¿ç¨‹ idã€‚
- æœ€å¤šæ”¯æŒ 20 ä¸ªå¯ç”¨çš„æ–­ç‚¹ã€‚

## ğŸ’¡å‘½ä»¤è¯´æ˜

- **æ–­ç‚¹** `break / b`
  - åç§»ï¼š`b 0x1234`ï¼ˆç›¸å¯¹åˆå§‹åŠ¨æ€åº“çš„åç§»ï¼‰
  - å†…å­˜åœ°å€ï¼š`b 0x6e9bfe214c`ï¼ˆéœ€è¦å½“å‰ç¨‹åºæ­£åœ¨è¿è¡Œï¼‰
  - åº“å+åç§»ï¼š`b libraryname.so+0x1234`
  - å½“å‰åç§»ï¼š`b $+1`ï¼Œï¼ˆå½“å‰ä½ç½®+**æŒ‡ä»¤æ¡æ•°**ï¼‰
  - å¯ç”¨æ–­ç‚¹ï¼š`enable id`ï¼Œå¯ç”¨æŒ‡å®šæ–­ç‚¹ï¼ˆä½ å¯ä»¥åœ¨ `info` ä¸­æŸ¥çœ‹æ–­ç‚¹ä¿¡æ¯ï¼‰
  - ç¦ç”¨æ–­ç‚¹ï¼š`disable id`ï¼Œç¦ç”¨æŒ‡å®šæ–­ç‚¹
  - åˆ é™¤æ–­ç‚¹ï¼š`delete id`ï¼Œåˆ é™¤ç¬¬ id å·æ–­ç‚¹
- **è™šæ‹Ÿåç§»æ–­ç‚¹** `vbreak / vb` è®¾ç½®è™šæ‹Ÿåç§»æ–­ç‚¹
- **ç»§ç»­è¿è¡Œ** `continue / c`ï¼šç»§ç»­æ‰§è¡Œè‡³ä¸‹ä¸€æ–­ç‚¹
- **å•æ­¥è°ƒè¯•**
  - `step / s` å•æ­¥æ­¥å…¥ï¼ˆè¿›å…¥å‡½æ•°è°ƒç”¨ï¼‰
  - `next / n` å•æ­¥æ­¥è¿‡ï¼ˆè·³è¿‡å‡½æ•°è°ƒç”¨ï¼‰
- **æŸ¥çœ‹å†…å­˜** `examine / x`
  - åœ°å€ï¼š`x 0x12345678`ï¼ˆé»˜è®¤é•¿åº¦ 16ï¼‰
  - åœ°å€+é•¿åº¦ï¼š`x 0x12345678 128`
  - åœ°å€+ç±»å‹ï¼š`x X0 ptr/str/int`
  - åœ°å€å’Œé•¿åº¦å¯ä»¥æ˜¯ä»»æ„è¡¨è¾¾å¼ï¼Œå…è®¸ä½¿ç”¨å¯„å­˜å™¨åç§°ä½œä¸ºå˜é‡å¦‚`x SP+128 X1+0x58`
- **æŸ¥çœ‹è°ƒç”¨æ ˆ** `backtrace1 / bt1` æˆ–è€… `backtrace2 / bt2`  
- **é€€å‡º** `quit / q`ï¼šé€€å‡º**è°ƒè¯•å™¨**ï¼ˆä¸ä¼šå½±å“ç¨‹åºè¿è¡Œï¼‰
- **æŸ¥çœ‹ä¿¡æ¯** `info / i`

  - `info b/break`ï¼šåˆ—å‡ºå½“å‰æ‰€æœ‰æ–­ç‚¹ï¼ˆ`[+]`=å·²å¯ç”¨ï¼Œ`[-]`=æœªå¯ç”¨ï¼‰
  - `info register/reg/r`ï¼šæŸ¥çœ‹æ‰€æœ‰å¯„å­˜å™¨ä¿¡æ¯ã€‚
  - `info thread/t`ï¼šåˆ—å‡ºå½“å‰æ‰€æœ‰çº¿ç¨‹å’Œå·²è®¾å®šçš„çº¿ç¨‹è¿‡æ»¤å™¨ã€‚
  - `info file/f`ï¼šæ‰“å°æŒ‡å®šæ–‡ä»¶çš„åœ°å€å’Œåç§»ã€‚
- **é‡å¤ä¸Šä¸€æ¡æŒ‡ä»¤**ï¼šç›´æ¥å›è½¦

æ›´å¤šå‘½ä»¤è§â€œè¿›é˜¶ä½¿ç”¨â€

## ğŸ§‘â€ğŸ’» è¿›é˜¶ä½¿ç”¨

å…¶ä»–çš„å¯ç”¨é€‰é¡¹ï¼š

| é€‰é¡¹åç§°               | å«ä¹‰                                                         |
| ---------------------- | ------------------------------------------------------------ |
| -t                     | çº¿ç¨‹åç§°è¿‡æ»¤å™¨ï¼ˆé€—å·åˆ†éš”ï¼‰                                   |
| -i filename            | ä½¿ç”¨é…ç½®æ–‡ä»¶                                                 |
| -s                     | ä¿å­˜è¿›åº¦åˆ°ä½¿ç”¨çš„é…ç½®æ–‡ä»¶                                     |
| -o filename            | ä¿å­˜è¿›åº¦åˆ°æŒ‡å®šæ–‡ä»¶åï¼ˆä¸ -s å†²çªï¼‰                           |
| -hide-register         | ç¦ç”¨å¯„å­˜å™¨ä¿¡æ¯è¾“å‡º                                           |
| -hide-disassemble      | ç¦ç”¨åæ±‡ç¼–ä»£ç è¾“å‡º                                           |
| -prefer                | uprobe æˆ– hardwareï¼ŒæŒ‡å®šåœ¨å•æ­¥è°ƒè¯•ä¸­ä½¿ç”¨çš„æ–­ç‚¹ï¼Œé»˜è®¤æ··ç”¨     |
| -disable-color         | ç¦ç”¨å½©è‰²è¾“å‡º                                                 |
| -disable-package-check | ç¦ç”¨åŒ…åæ£€æŸ¥ï¼Œæ­¤æ—¶åŒ…åå¯ä»¥æ˜¯è¿›ç¨‹åï¼Œåº“åå¿…é¡»ä½¿ç”¨ç»å¯¹è·¯å¾„ã€‚**æµ‹è¯•åŠŸèƒ½** |

æ›´å¤šçš„å¯ç”¨å‘½ä»¤ï¼š

- **ç¡¬ä»¶æ–­ç‚¹** `hbreak`ï¼šä¸ break ç”¨æ³•ç›¸åŒï¼Œé™åˆ¶ 4 ä¸ªä»¥å†…ã€‚

- **å†™ç›‘æ§** `watch`ï¼šä¸ break ç”¨æ³•ç›¸åŒï¼Œå½“æŒ‡å®šåœ°å€è¢«å†™å…¥æ—¶è§¦å‘ï¼Œå±äºç¡¬ä»¶æ–­ç‚¹ã€‚

- **è¯»ç›‘æ§** `rwatch`ï¼šåŒä¸Šã€‚

- **é€€å‡ºå‡½æ•°** `finish / fi`ï¼šæ‰§è¡Œç›´åˆ°å½“å‰å‡½æ•°é€€å‡º

  > ç›®å‰è¿™ä¸ªåŠŸèƒ½çš„å®é™…å®ç°æ˜¯åŸºäº LR çš„ï¼Œå¦‚æœ LR è¢«ç”¨ä½œåˆ«çš„ç”¨é€”è¯·ä½¿ç”¨ until 

- **è¿è¡Œç›´åˆ°** `until / u`ï¼šè¿è¡Œç›´åˆ°æŒ‡å®šåœ°å€ã€‚åœ°å€çš„æŒ‡å®šæ–¹æ³•ä¸æ–­ç‚¹ç›¸åŒ

- **å†™å†…å­˜** `write 0x1235 62626262`ï¼šå‘æŒ‡å®šåœ°å€å†™å…¥ Hex Stringï¼Œåœ°å€æŒ‡å®šæ–¹æ³•ä¸ `examine` ç›¸åŒï¼Œç›®æ ‡åœ°å€å¿…é¡»å¯å†™

- **Dump å†…å­˜** `dump address length filename`ï¼šå°†æŒ‡å®šåœ°å€çš„å†…å­˜å†™å…¥æ–‡ä»¶

- **å±•ç¤ºå†…å­˜** `display / disp`

  - åœ°å€ï¼š`disp 0x123456`ï¼Œ(æ¯æ¬¡è§¦å‘æ–­ç‚¹æˆ–å•æ­¥æ—¶æ‰“å°)

  - åœ°å€+é•¿åº¦ï¼š`disp 0x123456 128`

  - åœ°å€+é•¿åº¦+å˜é‡åï¼š`disp 0x123456 128 name`ï¼Œå±•ç¤ºåŒæ—¶æ‰“å°è¯¥å˜é‡å

    > âš ï¸ è‹¥å†…å­˜åœ°å€å˜åŒ–ï¼ˆe.g. åº”ç”¨é‡å¯ï¼‰ï¼Œæ­¤åŠŸèƒ½å°†æ— æ³•è¾“å‡ºæ­£ç¡®ä¿¡æ¯ã€‚

- **å–æ¶ˆå±•ç¤ºå†…å­˜**`undisplay / undisp <id>`ï¼šå–æ¶ˆå±•ç¤ºç¬¬ id å·å˜é‡

- **è®¾ç½®ç¬¦å·** `set address name`ï¼šè®¾ç½®æŒ‡å®šåœ°å€ç¬¦å·ã€‚

- **çº¿ç¨‹ç›¸å…³** `thread / t`

  - `t`ï¼šåˆ—å‡ºæ‰€æœ‰å¯ç”¨çº¿ç¨‹ã€‚
  - `t + 0`ï¼šå¢åŠ çº¿ç¨‹è¿‡æ»¤å™¨åœ¨ç¬¬ 0 ä¸ªçº¿ç¨‹ï¼ˆä½¿ç”¨`info t`æŸ¥çœ‹æ‰€æœ‰çº¿ç¨‹ idï¼‰ï¼Œæ³¨æ„ä¸æ˜¯æŒ‡å®š `tid`
  - `t - 0`ï¼šå–æ¶ˆç¬¬ 0 ä¸ªçº¿ç¨‹è¿‡æ»¤å™¨
  - `t all`ï¼šåˆ é™¤æ‰€æœ‰çº¿ç¨‹è¿‡æ»¤å™¨ã€‚
  - `t +n threadname`ï¼šå¢åŠ çº¿ç¨‹åç§°è¿‡æ»¤å™¨ã€‚

- **æŸ¥çœ‹ä»£ç ** `list / l / disassemble / dis`

  - ç›´æ¥æŸ¥çœ‹ï¼š`l`ï¼Œæ‰“å°å½“å‰ PC ä½ç½®å¼€å§‹ 10 æ¡æŒ‡ä»¤
  - æŸ¥çœ‹æŒ‡å®šåœ°å€ï¼š`l 0x1234`ï¼Œæ‰“å°å¯¹åº”å†…å­˜åœ°å€ 10 æ¡æŒ‡ä»¤
  - æŸ¥çœ‹æŒ‡å®šåœ°å€æŒ‡å®šé•¿åº¦æŒ‡ä»¤ï¼š`l 0x1234 20`ï¼Œæ‰“å°å¯¹åº”å†…å­˜åœ°å€å¯¹åº”**æŒ‡ä»¤æ¡æ•°**çš„æŒ‡ä»¤

## ğŸ›« ç¼–è¯‘

1. ç¯å¢ƒå‡†å¤‡

   æœ¬é¡¹ç›®åœ¨ x86 Linux ä¸‹äº¤å‰ç¼–è¯‘

   ```shell
   sudo apt-get update
   sudo apt-get install golang-1.18
   sudo apt-get install clang-14
   export GOPROXY=https://goproxy.cn,direct
   export GO111MODULE=on
   ```

2. ç¼–è¯‘

   ```shell
   git clone --recursive https://github.com/ShinoLeah/eDBG.git
   ./build_env.sh
   make
   ```

## ğŸ’­ å®ç°åŸç†

- æ‰€æœ‰æ–­ç‚¹å‡åŸºäº uprobeï¼Œå¦‚æœä½ å¾ˆåœ¨æ„è¢«æ£€æµ‹åˆ°ï¼Œè¯·å‚è€ƒæœ€ä¸‹æ–¹æ–‡ç« 
- `step / next / until / finish` åœ¨é»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨ç¡¬ä»¶æ–­ç‚¹ï¼ˆä»…åœ¨è·³è½¬æŒ‡ä»¤ä½¿ç”¨ uprobeï¼‰ï¼Œæ— æ³•è¢«ç”¨æˆ·æ€æ¢æµ‹åˆ°ï¼Œå¯ä»¥æ”¾å¿ƒä½¿ç”¨ï¼ˆå¦‚æœè¿™ä¸ªåŠŸèƒ½æ²¡æ³•å·¥ä½œï¼Œè€ƒè™‘ä½¿ç”¨ `prefer=hardware` æˆ– `prefer=uprobe`ï¼‰
- å»ºè®®ä½¿ç”¨ b åœ¨è·³è½¬æŒ‡ä»¤å¤„ä¸‹æ–­ç‚¹æ­é…å•æ­¥ä½¿ç”¨ã€‚
- [eDBG ä½¿ç”¨è¿›é˜¶ï¼šé¿å… uprobes äº§ç”Ÿå¯è¢«å¯Ÿè§‰çš„ç‰¹å¾](https://www.sh1no.icu/posts/28348c4/)

## ğŸ¤ å‚è€ƒ

- [SeeFlowerX/stackplz](https://github.com/SeeFlowerX/stackplz/tree/dev)
- [pwndbg](https://github.com/pwndbg/pwndbg)

## â¤ï¸â€ğŸ©¹ å…¶ä»–

- å–œæ¬¢çš„è¯å¯ä»¥ç‚¹ç‚¹å³ä¸Šè§’ Star ğŸŒŸ
- æ¬¢è¿æå‡º Issue æˆ– PRï¼
